!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o=function e(t){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=Array.prototype.forEach,o=Array.prototype.map,this.each=function(e,t,i){if(null!==e)if(n&&e.forEach===n)e.forEach(t,i);else if(e.length===+e.length){for(var o=0,s=e.length;o<s;o++)if(t.call(i,e[o],o,e)==={})return}else for(var a in e)if(e.hasOwnProperty(a)&&t.call(i,e[a],a,e)==={})return},this.map=function(e,t,n){var i=[];return null==e?i:o&&e.map===o?e.map(t,n):(this.each(e,function(e,o,s){i[i.length]=t.call(n,e,o,s)}),i)},"object"==(void 0===t?"undefined":i(t))?(this.hasher=t.hasher,this.screen_resolution=t.screen_resolution,this.screen_orientation=t.screen_orientation,this.canvas=t.canvas,this.ie_activex=t.ie_activex):"function"==typeof t&&(this.hasher=t)};t.default=o,o.prototype={get:function(){var e=[];(e.push(navigator.userAgent),e.push(navigator.language),e.push(screen.colorDepth),this.screen_resolution)&&(void 0!==this.getScreenResolution()&&e.push(this.getScreenResolution().join("x")));return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!window.indexedDB),document.body?e.push(i(document.body.addBehavior)):e.push("undefined"),e.push(i(window.openDatabase)),e.push(navigator.cpuClass),e.push(navigator.platform),e.push(navigator.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},murmurhash3_32_gc:function(e,t){var n,i,o,s,a,c,r,l;for(n=3&e.length,i=e.length-n,o=t,a=3432918353,c=461845907,l=0;l<i;)r=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24,++l,o=27492+(65535&(s=5*(65535&(o=(o^=r=(65535&(r=(r=(65535&r)*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*c+(((r>>>16)*c&65535)<<16)&4294967295)<<13|o>>>19))+((5*(o>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(r=0,n){case 3:r^=(255&e.charCodeAt(l+2))<<16;case 2:r^=(255&e.charCodeAt(l+1))<<8;case 1:o^=r=(65535&(r=(r=(65535&(r^=255&e.charCodeAt(l)))*a+(((r>>>16)*a&65535)<<16)&4294967295)<<15|r>>>17))*c+(((r>>>16)*c&65535)<<16)&4294967295}return o^=e.length,o=2246822507*(65535&(o^=o>>>16))+((2246822507*(o>>>16)&65535)<<16)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return!0}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!0}},isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},getPluginsString:function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){return this.map(["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"],function(e){try{return new ActiveXObject(e),e}catch(e){return null}}).join(";")}return""},getScreenResolution:function(){return this.screen_orientation?screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height]:[screen.height,screen.width]},getCanvasFingerprint:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()_+-={}|[]:"<>?;,.';return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()}}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.onOOCEnter=I,t.onEnter=C,t.musiclist_click=B,t.area_click=k,t.changeMusicVolume=x,t.changeSFXVolume=T,t.changeBlipVolume=S,t.changeCharacter=L,t.imgError=O,t.demoError=M,t.ReconnectButton=A,t.RetryButton=R,t.pickChar=j,t.pickEmotion=F,t.pickEvidence=U,t.addEvidence=Z,t.editEvidence=X,t.deleteEvidence=G,t.cancelEvidence=V,t.getIndexFromSelect=z,t.updateEvidenceIcon=W,t.updateActionCommands=q,t.changeBackgroundOOC=K,t.changeRoleOOC=Q,t.randomCharacterOOC=J,t.callMod=Y,t.initWT=ee,t.initCE=te,t.addHPD=ne,t.redHPD=ie,t.addHPP=oe,t.redHPP=se,t.updateBackgroundPreview=ae,t.toggleEffect=ce,t.toggleFlip=re,t.togglePresent=le,t.toggleMenu=de,t.toggleShout=ue;var o=c(n(5)),s=c(n(6)),a=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l={};location.search.substr(1).split("&").forEach(function(e){l[e.split("=")[0]]=e.split("=")[1]});var d=l.ip,u=l.mode,m=l.asset||"http://s3.wasabisys.com/webao/base/",h=m+"sounds/music/",g=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&(g=!0);var f=0,p=1,y=0,v=new a.default({canvas:!0,ie_activex:!0,screen_resolution:!0}).get();console.log(v);var E=new Date(0),_=function(){function e(t){var n=this;r(this,e),this.serv=new WebSocket("ws://"+t),this.serv.onopen=function(e){return n.onOpen(e)},this.serv.onclose=function(e){return n.onClose(e)},this.serv.onmessage=function(e){return n.onMessage(e)},this.serv.onerror=function(e){return n.onError(e)},this.flip=!1,this.presentable=!1,this.hp=[0,0],this.playerID=1,this.charID=-1,this.testimonyID=0,this.chars=[],this.emotes=[],this.evidences=[],this.resources={holdit:{src:"misc/holdit.gif",duration:720},objection:{src:"misc/objection.gif",duration:720},takethat:{src:"misc/takethat.gif",duration:840},witnesstestimony:{src:"misc/witnesstestimony.gif",duration:1560,sfx:"sounds/general/sfx-testimony.wav"},crossexamination:{src:"misc/crossexamination.gif",duration:1600,sfx:"sounds/general/sfx-testimony2.wav"}},this.selectedEmote=-1,this.selectedEvidence=0,this.checkUpdater=null,this.musicList=Object(),this.handlers={MS:function(e){return n.handleMS(e)},CT:function(e){return n.handleCT(e)},MC:function(e){return n.handleMC(e)},RMC:function(e){return n.handleRMC(e)},CI:function(e){return n.handleCI(e)},SC:function(e){return n.handleSC(e)},EI:function(e){return n.handleEI(e)},LE:function(e){return n.handleLE(e)},EM:function(e){return n.handleEM(e)},SM:function(e){return n.handleSM(e)},music:function(e){return n.handlemusic(e)},DONE:function(e){return n.handleDONE(e)},BN:function(e){return n.handleBN(e)},NBG:function(e){return n.handleNBG(e)},HP:function(e){return n.handleHP(e)},RT:function(e){return n.handleRT(e)},ZZ:function(e){return n.handleZZ(e)},ID:function(e){return n.handleID(e)},PN:function(e){return n.handlePN(e)},SI:function(e){return n.handleSI(e)},CharsCheck:function(e){return n.handleCharsCheck(e)},PV:function(e){return n.handlePV(e)},CHECK:function(e){}},this._lastTimeICReceived=new Date(0)}return i(e,[{key:"me",value:function(){return this.chars[this.charID]}},{key:"myEmote",value:function(){return this.emotes[this.selectedEmote]}},{key:"myEvidence",value:function(){return this.presentable?this.selectedEvidence:0}},{key:"sendOOC",value:function(e){this.serv.send("CT#"+me(ge(document.getElementById("OOC_name").value))+"#"+me(ge(e))+"#%")}},{key:"sendIC",value:function(e,t,n,i,o,s,a,c,r,l,d,u,m){this.serv.send("MS#chat#"+e+"#"+t+"#"+n+"#"+me(ge(i))+"#"+o+"#"+s+"#"+a+"#"+this.charID+"#"+c+"#"+y+"#"+l+"#"+d+"#"+u+"#"+m+"#%")}},{key:"sendPE",value:function(e,t,n){this.serv.send("PE#"+me(ge(e))+"#"+me(ge(t))+"#"+n+"#%")}},{key:"sendEE",value:function(e,t,n,i){this.serv.send("EE#"+e+"#"+me(ge(t))+"#"+me(ge(n))+"#"+i+"#%")}},{key:"sendDE",value:function(e){this.serv.send("DE#"+e+"#%")}},{key:"sendHP",value:function(e,t){this.serv.send("HP#"+e+"#"+t+"#%")}},{key:"sendZZ",value:function(e){this.serv.send("ZZ#"+e+"#%")}},{key:"sendRT",value:function(e){"jud"==this.chars[this.charID].side&&this.serv.send("RT#"+e+"#%")}},{key:"sendMusicChange",value:function(e){this.serv.send("MC#"+e+"#"+this.charID+"#%")}},{key:"sendLeaveRoom",value:function(){this.serv.send("FC#%")}},{key:"joinServer",value:function(){var e=this;this.serv.send("HI#"+v+"#%"),this.serv.send("ID#webAO#2.3#%"),this.checkUpdater=setInterval(function(){return e.sendCheck()},5e3)}},{key:"loadResources",value:function(){document.getElementById("OOC_name").value="web"+this.playerID;var e=document.getElementById("evi_select");e.add(new Option("Custom",0)),s.default.forEach(function(t){e.add(new Option(t))});var t=document.getElementById("bg_select");t.add(new Option("Custom",0)),o.default.forEach(function(e){t.add(new Option(e))});for(var n=["holdit","objection","takethat"],i=0;i<n.length;i++){P(m+this.resources[n[i]].src.toLowerCase(),this.callbackLoadImageResources,n[i])}for(var a=["witnesstestimony","crossexamination"],c=0;c<a.length;c++){P(m+"themes/default/"+a[c]+".gif",this.callbackLoadImageResources,a[c]),P(m+this.resources[a[c]].sfx.toLowerCase(),this.callbackLoadSFXResources,a[c])}}},{key:"callbackLoadImageResources",value:function(e,t,n){e&&(pe.resources[t].src=n,ye.getAnimLength(n,pe.callbackGetResourceLength,t))}},{key:"callbackGetResourceLength",value:function(e,t){pe.resources[t].duration=e}},{key:"callbackLoadSFXResources",value:function(e,t,n){e&&(pe.resources[t].sfx=n)}},{key:"initialObservBBCode",value:function(){var e=document.getElementById("client_inner_chat");new MutationObserver(function(e){e.forEach(function(e){var t=e.addedNodes;null!==t&&t.forEach(function(e){"C"==e.tagName?e.style.color=e.getAttribute("a"):"M"==e.tagName&&(e.hasAttribute("a")?e.style.backgroundColor=e.getAttribute("a"):(e.style.backgroundColor="yellow",e.style.color="black"))})})}).observe(e,{attributes:!0,childList:!0})}},{key:"sendCharacter",value:function(e){this.serv.send("CC#"+this.playerID+"#"+e+"#web#%")}},{key:"sendMusic",value:function(e){this.serv.send("MC#"+e)}},{key:"sendCheck",value:function(){this.serv.send("CH#"+this.charID+"#%")}},{key:"onOpen",value:function(e){"watch"===u?(document.getElementById("client_loading").style.display="none",document.getElementById("client_charselect").style.display="none"):pe.joinServer()}},{key:"onClose",value:function(e){console.error("The connection was closed: "+e.reason+" ("+e.code+")"),1001!==e.code&&(document.getElementById("client_error").style.display="block",document.getElementById("error_id").textContent=e.code,this.cleanup())}},{key:"onMessage",value:function(e){var t=e.data;console.debug(t);var n=t.split("%")[0].split("#"),i=n[0],o=this.handlers[i];void 0!==o?o(n):console.warn("Invalid packet header "+i)}},{key:"onError",value:function(e){console.error("A network error occurred: "+e.reason+" ("+e.code+")"),document.getElementById("client_error").style.display="block",document.getElementById("error_id").textContent=e.code,this.cleanup()}},{key:"cleanup",value:function(){try{this.serv.close(1001)}catch(e){}clearInterval(this.checkUpdater)}},{key:"prepChat",value:function(e){return he(fe(e)).replace(/\\n/g,"<br>").replace(/\[(\/?)b\]/g,"<$1b>").replace(/\[(\/?)i\]/g,"<$1i>").replace(/\[(\/?)s\]/g,"<$1del>").replace(/\[(\/?)u\]/g,"<$1u>").replace(/\[(\/?)sub\]/g,"<$1sub>").replace(/\[(\/?)sup\]/g,"<$1sup>").replace(/\[m=([#a-zA-Z0-9]+)\]/g,'<m a="$1">').replace(/\[(\/?)m\]/g,"<$1m>").replace(/\[c=?([#a-zA-Z0-9]+)\]/g,'<c a="$1">').replace(/\[\/c\]/g,"</c>")}},{key:"handleMS",value:function(e){if(e[4]!=ye.chatmsg.content){document.getElementById("client_inner_chat").innerHTML="";for(var t={character:-1,preanim:escape(e[2]),nameplate:e[3],name:e[3],speaking:"(b)"+escape(e[4]),silent:"(a)"+escape(e[4]),content:this.prepChat(e[5]),side:e[6],sound:escape(e[7]),type:e[8],snddelay:e[10],objection:e[11],evidence:e[12],flip:e[13],flash:e[14],color:e[15],isnew:!0},n=0;n<this.chars.length;n++)if(this.chars[n].name==e[3]){t.character=n;break}t.character==this.charID&&function(){document.getElementById("client_inputbox").value="",f&&(document.getElementById("button_effect_"+f).className="client_button",f=0);y&&(document.getElementById("button_"+y).className="client_button",y=0)}(),ye.say(t)}}},{key:"handleCT",value:function(e){var t=document.getElementById("client_ooclog");t.innerHTML+=fe(he(e[1]))+": "+fe(he(e[2]))+"\r\n",t.scrollTop>t.scrollHeight-600&&(t.scrollTop=t.scrollHeight)}},{key:"handleMC",value:function(e){var t=ye.music;(t.pause(),t.src=h+e[1].toLowerCase(),t.play(),e[2]>=0)?H(this.chars[e[2]].name+" changed music to "+e[1]):H("The music was changed to "+e[1])}},{key:"handleRMC",value:function(e){ye.music.pause(),ye.music=new Audio(this.musicList[e[1]]);var t=ye.music;t.totime=e[1],t.offset=(new Date).getTime()/1e3,t.addEventListener("loadedmetadata",function(){t.currentTime+=parseFloat(t.totime+((new Date).getTime()/1e3-t.offset)).toFixed(3),t.play()},!1)}},{key:"handleCI",value:function(e){document.getElementById("client_loadingtext").innerHTML="Loading Character "+e[1],this.serv.send("AN#"+(e[1]/10+1)+"#%");for(var t=2;t<e.length-1;t++)if(t%2==0){var n=e[t].split("&");this.chars[e[t-1]]={name:n[0],desc:n[1],evidence:n[3],icon:m+"characters/"+escape(n[0].toLowerCase())+"/char_icon.png"}}}},{key:"handleSC",value:function(e){document.getElementById("client_loadingtext").innerHTML="Loading Characters";for(var t=1;t<e.length-1;t++){var n=e[t].split("&");this.chars[t-1]={name:n[0],desc:n[1],evidence:n[3],icon:m+"characters/"+escape(n[0].toLowerCase())+"/char_icon.png"}}this.serv.send("RM#%")}},{key:"handleEI",value:function(e){document.getElementById("client_loadingtext").innerHTML="Loading Evidence "+e[1],this.serv.send("RM#%")}},{key:"handleLE",value:function(e){this.evidences=[];for(var t=1;t<e.length-1;t++){var n=e[t].split("&");this.evidences[t-1]={name:fe(he(n[0])),desc:fe(he(n[1])),filename:escape(n[2]),icon:m+"evidence/"+escape(n[2].toLowerCase())}}var i=document.getElementById("evidences");i.innerHTML="";for(var o=1;o<=this.evidences.length;o++)i.innerHTML+='<img src="'+this.evidences[o-1].icon+'" \n\t\t\t\tid="evi_'+o+'" \n\t\t\t\talt="'+this.evidences[o-1].name+'"\n\t\t\t\tclass="client_button"\n\t\t\t\tonclick="pickEvidence('+o+')">'}},{key:"handleEM",value:function(e){document.getElementById("client_loadingtext").innerHTML="Loading Music "+e[1],this.serv.send("AM#"+(e[1]/10+1)+"#%");for(var t=document.getElementById("client_musiclist"),n=2;n<e.length-1;n++)if(n%2==0){var i=document.createElement("OPTION");i.text=e[n],t.options.add(i)}}},{key:"handleSM",value:function(e){document.getElementById("client_loadingtext").innerHTML="Loading Music ";for(var t=document.getElementById("client_musiclist"),n=!1,i=1;i<e.length-1;i++)if(/\.(?:wav|mp3|mp4|ogg|opus)$/i.test(e[i])&&!n&&(n=!0),n){var o=document.createElement("OPTION");o.text=e[i],t.options.add(o)}else{var s=document.createElement("SPAN");s.className="location-box",s.textContent=e[i],s.onclick=function(){k(this)},document.getElementById("areas").appendChild(s)}var a=document.getElementById("areas");if(a.lastChild.textContent.startsWith("=")){var c=document.createElement("OPTION");c.text=a.lastChild.textContent,t.insertBefore(c,t.firstChild),a.removeChild(a.lastChild)}this.serv.send("RD#%")}},{key:"handlemusic",value:function(e){for(var t=0;t<e.length/2;t++)this.musicList[e[2*t]]=e[2*t+1]}},{key:"handleDONE",value:function(e){document.getElementById("client_loading").style.display="none",document.getElementById("client_charselect").style.display="block"}},{key:"handleBN",value:function(e){ye.bgname=escape(e[1]);var t=z("bg_select",escape(e[1]));document.getElementById("bg_select").selectedIndex=t,ae(),0==t&&(document.getElementById("bg_filename").value=e[1]),document.getElementById("bg_preview").src=m+"background/"+escape(e[1].toLowerCase())+"/defenseempty.png",-1==this.charID?N("jud"):N(this.chars[this.charID].side)}},{key:"handleNBG",value:function(e){}},{key:"handleHP",value:function(e){var t=10*e[2];1==e[1]?(this.hp[0]=e[2],$("#client_defense_hp > .health-bar").animate({width:t+"%"},500)):(this.hp[1]=e[2],$("#client_prosecutor_hp > .health-bar").animate({width:t+"%"},500))}},{key:"handleRT",value:function(e){"testimony1"==e[1]?this.testimonyID=1:this.testimonyID=2,ye.initTestimonyUpdater()}},{key:"handleZZ",value:function(e){var t=document.getElementById("client_ooclog");t.innerHTML+="$Alert: "+fe(he(e[1]))+"\r\n",t.scrollTop>t.scrollHeight-60&&(t.scrollTop=t.scrollHeight)}},{key:"handleID",value:function(e){this.playerID=e[1]}},{key:"handlePN",value:function(e){this.serv.send("askchaa#%")}},{key:"handleSI",value:function(e){g?this.serv.send("askchar2#%"):this.serv.send("RC#%")}},{key:"handleCharsCheck",value:function(e){document.getElementById("client_chartable").innerHTML="";for(var t=void 0,n=0;n<this.chars.length;n++){n%8==0&&(t=document.createElement("TR"));var i=document.createElement("TD"),o="",s=this.chars[n].icon;"-1"==e[n+1]&&(o=" dark"),i.innerHTML="<img class='demothing"+o+"' id='demo_"+n+"' src='"+s+"' alt='"+this.chars[n].name+"' onclick='pickChar("+n+")' onerror='demoError(this);'>",t.appendChild(i),n%8==0&&document.getElementById("client_chartable").appendChild(t)}}},{key:"handlePV",value:function(e){this.charID=e[3],document.getElementById("client_charselect").style.display="none",document.getElementById("client_inputbox").style.display="";var t=this.me(),n=this.emotes,i=document.getElementById("client_emo");i.innerHTML="",i.style.display="";var o=new XMLHttpRequest;o.withCredentials=!1,o.open("GET",m+"characters/"+escape(this.me().name.toLowerCase())+"/char.ini",!0),o.responseType="text",o.onload=function(e){if(200==this.status){var o=this.responseText,s=b.parse(o);t.side=s.Options.side,q(t.side);for(var a=1;a<=s.Emotions.number;a++){var c=s.Emotions[a].split("#"),r="0",l="0";void 0!==s.SoundN&&(r=s.SoundN[a]),void 0!==s.SoundT&&(l=s.SoundT[a]),n[a]={desc:c[0].toLowerCase(),speaking:c[1].toLowerCase(),silent:c[2].toLowerCase(),zoom:c[3],sfx:r.toLowerCase(),sfxdelay:l,button_off:m+"characters/"+escape(t.name).toLowerCase()+"/emotions/button"+a+"_off.png",button_on:m+"characters/"+escape(t.name).toLowerCase()+"/emotions/button"+a+"_on.png"},i.innerHTML+="<img src="+n[a].button_off+'\n\t\t\t\t\t\t id="emo_'+a+'"\n\t\t\t\t\t\t alt="'+n[a].desc+'"\n\t\t\t\t\t\t class="client_button"\n\t\t\t\t\t\t onclick="pickEmotion('+a+')">'}F(1)}},o.send()}}]),e}(),w=function(){function e(){r(this,e),this.textnow="",this.chatmsg={isnew:!1,content:"",objection:"0",sound:"",startpreanim:!1,startspeaking:!1,side:null,color:"0",snddelay:0,preanimdelay:0},this.blip=new Audio(m+"sounds/general/sfx-blipmale.wav"),this.blip.volume=.5,this.blipChannels=new Array(6);for(var t=0;t<this.blipChannels.length;t++)this.blipChannels[t]=new Audio(m+"sounds/general/sfx-blipmale.wav"),this.blipChannels[t].volume=.5;this.currentBlipChannel=0,this.sfxaudio=new Audio(m+"sounds/general/sfx-blipmale.wav"),this.sfxplayed=0,this.music=new Audio,this.music.play(),this.updater=null,this.testimonyUpdater=null,this.bgname="gs4",this.testimonyTimer=0,this.shoutTimer=0,this.textTimer=0,this._animating=!1}return i(e,[{key:"isAnimating",value:function(){return this._animating}},{key:"setBlipVolume",value:function(e){for(var t=0;t<this.blipChannels.length;t++)this.blipChannels[t].volume=e}},{key:"bgFolder",value:function(){return m+"background/"+this.bgname.toLowerCase()+"/"}},{key:"say",value:function(e){this.chatmsg=e,H(e.content,e.nameplate),N(e.side),this.textnow="",this.sfxplayed=0,this.textTimer=0,this._animating=!0,clearTimeout(this.updater),"-"!=e.preanim?e.preanimdelay=this.getAnimLength(m+"characters/"+escape(e.name.toLowerCase())+"/"+e.preanim.toLowerCase()+".gif",this.initUpdater):this.initUpdater(0)}},{key:"initUpdater",value:function(e){ye.chatmsg.preanimdelay=parseInt(e),ye.updater=setTimeout(function(){return ye.updateText()},60)}},{key:"initTestimonyUpdater",value:function(){var e=this;if(pe.testimonyID>0){var t="";1==pe.testimonyID?t="witnesstestimony":2==pe.testimonyID&&(t="crossexamination"),new Audio(pe.resources[t].sfx).play(),this.testimonyTimer=0;var n=document.getElementById("client_testimony");n.src=pe.resources[t].src,n.style.display="",this.testimonyUpdater=setTimeout(function(){return e.updateTestimony()},60)}}},{key:"getAnimLength",value:function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.addEventListener("load",function(){var e=gify.getInfo(i.response);console.log(e.duration),t(e.duration,n)}),i.send()}},{key:"updateTestimony",value:function(){var e=this;this.testimonyTimer=this.testimonyTimer+60,1==pe.testimonyID?this.testimonyTimer>=pe.resources.witnesstestimony.duration?this.disposeTestimony():this.testimonyUpdater=setTimeout(function(){return e.updateTestimony()},60):2==pe.testimonyID?this.testimonyTimer>=pe.resources.crossexamination.duration?this.disposeTestimony():this.testimonyUpdater=setTimeout(function(){return e.updateTestimony()},60):this.disposeTestimony()}},{key:"disposeTestimony",value:function(){pe.testimonyID=0,this.testimonyTimer=0,document.getElementById("client_testimony").style.display="none",clearTimeout(this.testimonyUpdater)}},{key:"updateText",value:function(){var e=this,t=document.getElementById("client_name"),n=document.getElementById("client_chat"),i=document.getElementById("client_char"),o=document.getElementById("client_evi"),s=document.getElementById("client_background"),a=document.getElementById("client_shout"),c=document.getElementById("client_inner_chat");if(1==this.chatmsg.flip?i.style.transform="scaleX(-1)":i.style.transform="scaleX(1)",this._animating&&(this.updater=setTimeout(function(){return e.updateText()},60)),this.chatmsg.isnew){s.style.backgroundColor="transparent",t.style.display="none",n.style.display="none",o.style.opacity="0",o.style.height="0%";var r={1:"holdit",2:"objection",3:"takethat"}[this.chatmsg.objection];void 0!==r?(a.src=pe.resources[r].src,new Audio(m+"characters/"+this.chatmsg.name.toLowerCase()+"/"+r+".wav").play(),this.shoutTimer=850):this.shoutTimer=0,this.chatmsg.isnew=!1,this.chatmsg.startpreanim=!0}if(this.textTimer>=this.shoutTimer&&this.chatmsg.startpreanim)2==this.chatmsg.flash?(this.sfxaudio.pause(),this.sfxplayed=1,this.sfxaudio.src=m+"sounds/general/sfx-stab.wav",this.sfxaudio.play(),$("#client_gamewindow").effect("shake",{direction:"up"})):1==this.chatmsg.flash&&(s.style.backgroundColor="white",this.sfxaudio.pause(),this.sfxplayed=1,this.sfxaudio.src=m+"sounds/general/sfx-realization.wav",this.sfxaudio.play(),$("#client_gamewindow").effect("pulsate")),this.chatmsg.preanimdelay>0&&(a.src="misc/placeholder.gif",N(this.chatmsg.side),i.src=m+"characters/"+escape(this.chatmsg.name.toLowerCase())+"/"+this.chatmsg.preanim.toLowerCase()+".gif"),this.chatmsg.startpreanim=!1,this.chatmsg.startspeaking=!0;else if(this.textTimer>=this.shoutTimer+this.chatmsg.preanimdelay&&!this.chatmsg.startpreanim)if(this.chatmsg.startspeaking){for(this.chatmsg.evidence>0&&(o.style.backgroundImage="url('"+pe.evidences[this.chatmsg.evidence-1].icon+"')","def"==this.chatmsg.side?(o.style.right="1.5em",o.style.left="initial",$("#client_evi").animate({height:"30%",opacity:1},250)):(o.style.right="initial",o.style.left="1.5em",$("#client_evi").animate({height:"30%",opacity:1},250))),t.style.display="block",t.style.fontSize=.7*t.offsetHeight+"px";t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(this.chatmsg.nameplate)),n.style.display="block",n.style.fontSize=.25*n.offsetHeight+"px";c.style.color={0:"#ffffff",1:"#00ff00",2:"#ff0000",3:"#ffaa00",4:"#0000ff",5:"#ffff00",6:"#aa00aa"}[this.chatmsg.color]||"#ffffff",this.chatmsg.startspeaking=!1,0==this.chatmsg.preanimdelay&&(a.src="misc/placeholder.gif",N(this.chatmsg.side)),i.src=m+"characters/"+escape(this.chatmsg.name.toLowerCase())+"/"+this.chatmsg.speaking.toLowerCase()+".gif",this.textnow==this.chatmsg.content&&(i.src=m+"characters/"+escape(this.chatmsg.name.toLowerCase())+"/"+this.chatmsg.silent.toLowerCase()+".gif",this._animating=!1,clearTimeout(this.updater))}else if(this.textnow!=this.chatmsg.content){for(" "!=this.chatmsg.content.charAt(this.textnow.length)&&(this.blipChannels[this.currentBlipChannel].play(),this.currentBlipChannel++,this.currentBlipChannel%=this.blipChannels.length),this.textnow=this.chatmsg.content.substring(0,this.textnow.length+1);c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(document.createTextNode(this.textnow)),this.textnow==this.chatmsg.content&&(this.textTimer=0,this._animating=!1,i.src=m+"characters/"+escape(this.chatmsg.name.toLowerCase())+"/"+this.chatmsg.silent.toLowerCase()+".gif",clearTimeout(this.updater))}!this.sfxplayed&&this.chatmsg.snddelay+this.shoutTimer>=this.textTimer&&(this.sfxaudio.pause(),this.sfxplayed=1,"0"!=this.chatmsg.sound&&"1"!=this.chatmsg.sound&&(this.sfxaudio.src=m+"sounds/general/"+escape(this.chatmsg.sound.toLowerCase())+".wav",this.sfxaudio.play())),this.textTimer=this.textTimer+60}}]),e}(),b=function(){function e(){r(this,e)}return i(e,null,[{key:"parse",value:function(e){var t={section:/^\s*\[\s*([^\]]*)\s*\]\s*$/,param:/^\s*([\w.\-_]+)\s*=\s*(.*?)\s*$/,comment:/^\s*;.*$/},n={},i=e.split(/\r\n|\r|\n/),o=null;return i.forEach(function(e){if(!t.comment.test(e)&&0!=e.length)if(t.param.test(e)){var i=e.match(t.param);o?n[o][i[1]]=i[2]:n[i[1]]=i[2]}else if(t.section.test(e)){var s=e.match(t.section);n[s[1]]={},o=s[1]}}),n}}]),e}();function I(e){13==e.keyCode&&(pe.sendOOC(document.getElementById("client_oocinputbox").value),document.getElementById("client_oocinputbox").value="")}function C(e){if(13==e.keyCode){var t=pe.me(),n=pe.myEmote(),i=pe.myEvidence(),o=pe.flip?1:0,s=document.getElementById("textcolor").value,a="0",c="0";document.getElementById("sendsfx").checked&&(a=n.sfx,c=n.sfxdelay),pe.sendIC(n.speaking,t.name,n.silent,document.getElementById("client_inputbox").value,t.side,a,n.zoom,c,y,i,o,f,s)}}function B(e){var t=document.getElementById("client_musiclist").value;pe.sendMusicChange(t)}function k(e){var t=e.textContent;pe.sendMusicChange(t);var n=document.createElement("div");n.className="hrtext",n.textContent="switched to "+e.textContent,document.getElementById("client_log").appendChild(n)}function x(){ye.music.volume=document.getElementById("client_mvolume").value/100}function T(){ye.sfxaudio.volume=document.getElementById("client_svolume").value/100}function S(){ye.setBlipVolume(document.getElementById("client_bvolume").value/100)}function L(e){pe.sendLeaveRoom(),document.getElementById("client_charselect").style.display="block",document.getElementById("client_emo").innerHTML=""}function O(e){return e.onerror="",e.src="misc/placeholder.gif",!0}function M(e){return e.onerror="",e.src="/misc/placeholder.png",!0}function P(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&200==this.status?t(!0,n,e):t(!1,n,e)},i.open("GET",e,!0),i.send()}function N(e){var t=void 0,n=ye.bgFolder();switch(document.getElementById("client_fg").style.display="none",document.getElementById("client_bench").style.display="none",e){case"def":document.getElementById("client_court").src=n+"defenseempty.png",document.getElementById("client_bench").style.display="block",P(n+"defensedesk.png",D,e),t="defense";break;case"pro":document.getElementById("client_court").src=n+"prosecutorempty.png",document.getElementById("client_bench").style.display="block",P(n+"defensedesk.png",D,e),t="prosecution";break;case"hld":document.getElementById("client_court").src=n+"helperstand.png",t="defense";break;case"hlp":document.getElementById("client_court").src=n+"prohelperstand.png",t="prosecution";break;case"wit":document.getElementById("client_court").src=n+"witnessempty.png",document.getElementById("client_bench").style.display="block",document.getElementById("client_bench").src=n+"estrado.png",t="prosecution";break;case"jud":document.getElementById("client_court").src=n+"judgestand.png",t="prosecution"}5==ye.chatmsg.type&&(document.getElementById("client_bench").style.display="none",document.getElementById("client_court").src=m+"themes/default/"+t+"_speedlines.gif")}function D(e,t){var n=ye.bgFolder();document.getElementById("client_bench").src="def"==t?e?n+"defensedesk.png":n+"bancodefensa.png":e?n+"prosecutiondesk.png":n+"bancoacusacion.png"}function A(){pe.cleanup(),(pe=new _(d))&&(u="join",document.getElementById("client_error").style.display="none")}function R(){pe.joinServer()}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,i=document.createElement("p"),o=document.createElement("span");if(o.id="iclog_name",o.appendChild(document.createTextNode(t)),i.appendChild(o),i.appendChild(document.createTextNode(e)),E.getMinutes()!==n.getMinutes()){var s=document.createElement("span");s.id="iclog_time",s.innerText=n.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"}),i.appendChild(s)}var a=document.getElementById("client_log");a.appendChild(i),a.scrollTop>a.scrollHeight-800&&(a.scrollTop=a.scrollHeight),E=new Date}function j(e){e<1e3?pe.sendCharacter(e):(document.getElementById("client_charselect").style.display="none",document.getElementById("client_inputbox").style.display="none",document.getElementById("client_emo").style.display="none")}function F(e){-1!=pe.selectedEmote&&(document.getElementById("emo_"+pe.selectedEmote).src=pe.myEmote().button_off),pe.selectedEmote=e,document.getElementById("emo_"+e).src=pe.myEmote().button_on}function U(e){if(pe.selectedEvidence!==e){pe.selectedEvidence>0&&(document.getElementById("evi_"+pe.selectedEvidence).className="client_button"),document.getElementById("evi_"+e).className="client_button dark",pe.selectedEvidence=e,document.getElementById("evi_name").value=pe.evidences[e-1].name,document.getElementById("evi_desc").value=pe.evidences[e-1].desc;var t=z("evi_select",pe.evidences[e-1].filename);document.getElementById("evi_select").selectedIndex=t,0==t&&(document.getElementById("evi_filename").value=pe.evidences[e-1].filename),W(),document.getElementById("evi_add").className="client_button hover_button inactive",document.getElementById("evi_edit").className="client_button hover_button",document.getElementById("evi_cancel").className="client_button hover_button",document.getElementById("evi_del").className="client_button hover_button"}else V()}function Z(){var e=document.getElementById("evi_select");pe.sendPE(document.getElementById("evi_name").value,document.getElementById("evi_desc").value,0==e.selectedIndex?document.getElementById("evi_filename").value:e.options[e.selectedIndex].text),V()}function X(){var e=document.getElementById("evi_select"),t=parseInt(pe.selectedEvidence)-1;pe.sendEE(t,document.getElementById("evi_name").value,document.getElementById("evi_desc").value,0==e.selectedIndex?document.getElementById("evi_filename").value:e.options[e.selectedIndex].text),V()}function G(){var e=parseInt(pe.selectedEvidence)-1;pe.sendDE(e),V()}function V(){pe.selectedEvidence>0&&(document.getElementById("evi_"+pe.selectedEvidence).className="client_button"),pe.selectedEvidence=0,document.getElementById("evi_select").selectedIndex=0,W(),document.getElementById("evi_filename").value="",document.getElementById("evi_name").value="",document.getElementById("evi_desc").value="",document.getElementById("evi_icon").style.backgroundImage="url('misc/empty.png')",document.getElementById("evi_add").className="client_button hover_button",document.getElementById("evi_edit").className="client_button hover_button inactive",document.getElementById("evi_cancel").className="client_button hover_button inactive",document.getElementById("evi_del").className="client_button hover_button inactive"}function z(e,t){for(var n=document.getElementById(e),i=1;i<n.length;++i)if(n.options[i].value==t)return i;return 0}function W(){var e=document.getElementById("evi_select"),t=document.getElementById("evi_filename"),n=document.getElementById("evi_icon");0===e.selectedIndex?(t.style.display="initial",n.style.backgroundImage="url("+m+"evidence/"+t.value.toLowerCase()+")"):(t.style.display="none",n.style.backgroundImage="url("+m+"evidence/"+e.value.toLowerCase()+")")}function q(e){"jud"==e?(document.getElementById("judge_action").style.display="inline-table",document.getElementById("no_action").style.display="none"):(document.getElementById("no_action").style.display="inline-table",document.getElementById("judge_action").style.display="none");for(var t=0,n=document.getElementById("role_select").options;t<n.length;t++)if(e==n[t].value)return void(n.selectedIndex=t)}function K(){var e="",t=document.getElementById("bg_select"),n=document.getElementById("bg_command").value;e=0==t.selectedIndex?document.getElementById("bg_filename").value:t.value,pe.sendOOC("/"+n.replace("$1",e))}function Q(){var e=document.getElementById("role_select"),t=document.getElementById("role_command").value;pe.sendOOC("/"+t.replace("$1",e.value)),q(e.value)}function J(){pe.sendOOC("/"+document.getElementById("randomchar_command").value)}function Y(){$("#callmod_dialog").dialog("open")}function ee(){pe.sendRT("testimony1")}function te(){pe.sendRT("testimony2")}function ne(){pe.sendHP(1,String(parseInt(pe.hp[0])+1))}function ie(){pe.sendHP(1,String(parseInt(pe.hp[0])-1))}function oe(){pe.sendHP(2,String(parseInt(pe.hp[1])+1))}function se(){pe.sendHP(2,String(parseInt(pe.hp[1])-1))}function ae(){var e=document.getElementById("bg_select"),t=document.getElementById("bg_filename"),n=document.getElementById("bg_preview");0==e.selectedIndex?(t.style.display="initial",n.src=m+"background/"+t.value.toLowerCase()+"/defenseempty.png"):(t.style.display="none",n.src=m+"background/"+e.value.toLowerCase()+"/defenseempty.png")}function ce(e){e==f?(document.getElementById("button_effect_"+e).className="client_button",f=0):(document.getElementById("button_effect_"+e).className="client_button dark",f&&(document.getElementById("button_effect_"+f).className="client_button"),f=e)}function re(){pe.flip?document.getElementById("button_flip").className="client_button":document.getElementById("button_flip").className="client_button dark",pe.flip=!pe.flip}function le(){pe.presentable?document.getElementById("button_present").className="client_button":document.getElementById("button_present").className="client_button dark",pe.presentable=!pe.presentable}function de(e){e!=p&&(document.getElementById("menu_"+e).className="menu_icon active",document.getElementById("content_"+e).className="menu_content active",document.getElementById("menu_"+p).className="menu_icon",document.getElementById("content_"+p).className="menu_content",p=e)}function ue(e){e==y?(document.getElementById("button_"+e).className="client_button",y=0):(document.getElementById("button_"+e).className="client_button dark",y&&(document.getElementById("button_"+y).className="client_button"),y=e)}function me(e){return e.replace(/#/g,"<pound>").replace(/&/g,"<and>").replace(/%/g,"<percent>").replace(/\$/g,"<dollar>")}function he(e){return e.replace(/<pound>/g,"#").replace(/<and>/g,"&").replace(/<percent>/g,"%").replace(/<dollar>/g,"$")}function ge(e){var t=document.getElementById("client_encoding").value;if("unicode"==t)return e.replace(/[^\0-~]/g,function(e){return"\\u"+("000"+e.charCodeAt().toString(16)).slice(-4)});if("utf16"==t){for(var n=new ArrayBuffer(2*e.length),i=new Uint16Array(n),o=0,s=e.length;o<s;o++)i[o]=e.charCodeAt(o);return String(i)}return e}function fe(e){var t=document.getElementById("client_decoding").value;return"unicode"==t?e.replace(/\\u([\d\w]{1,})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))}):"utf16"==t?String.fromCharCode.apply(null,new Uint16Array(e.split(","))):e}window.onOOCEnter=I,window.onEnter=C,window.musiclist_click=B,window.area_click=k,window.changeMusicVolume=x,window.changeSFXVolume=T,window.changeBlipVolume=S,window.changeCharacter=L,window.imgError=O,window.demoError=M,window.ReconnectButton=A,window.RetryButton=R,window.pickChar=j,window.pickEmotion=F,window.pickEvidence=U,window.addEvidence=Z,window.editEvidence=X,window.deleteEvidence=G,window.cancelEvidence=V,window.getIndexFromSelect=z,window.updateEvidenceIcon=W,window.updateActionCommands=q,window.changeBackgroundOOC=K,window.changeRoleOOC=Q,window.randomCharacterOOC=J,window.callMod=Y,window.initWT=ee,window.initCE=te,window.addHPD=ne,window.redHPD=ie,window.addHPP=oe,window.redHPP=se,window.updateBackgroundPreview=ae,window.toggleEffect=ce,window.toggleFlip=re,window.togglePresent=le,window.toggleMenu=de,window.toggleShout=ue,void 0===String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")});var pe=new _(d),ye=new w;$(document).ready(function(){pe.initialObservBBCode(),pe.loadResources()}),$(function(){$("#callmod_dialog").dialog({autoOpen:!1,resizable:!1,show:{effect:"drop",direction:"down",duration:500},hide:{effect:"drop",direction:"down",duration:500},height:"auto",width:400,modal:!0,buttons:{Sure:function(){pe.sendZZ(""),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Anime","birthday","Christmas","CountyCourt","CruiseCourt","default","DGDEnglishCourt","DGSJapanCourt","DualDestinies","EnglishCourt","gs4","GS4Night","HD","Khura'in","mlp","NewCourt","RuinedCourt","Sky","SpaceCourt","Themis","TouhouCourt","WitchTrialCourt","Zetta"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["1.png","2.png","3.png","4.png","5.png","6.png","empty.png","lawyerbadge.png"]}]);
//# sourceMappingURL=client.b.js.map